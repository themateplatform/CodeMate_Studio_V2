# CodeVibe â†’ Lovable.dev Replacement: Whatâ€™s Left & How We Ship (v0.9)

*Updated: 27 Sep 2025 â€” Melbourne (AEST)*

## North Star & MVP

**Goal:** Ship a singleâ€‘owner, GitHubâ€‘first, AIâ€‘assisted app builder that can import an existing repo, edit it in-browser, generate code with AI, and push PRs with preview links.

**MVP must do:**

* âœ… Auth & orgs (done at backend); ğŸ”² minimal admin UI to manage org, members, roles
* ğŸ”² GitHub-first onboarding (OAuth â†’ pick repo/branch â†’ import â†’ index)
* ğŸ”² IDE core (file tree, Monaco editor, tabs, save, create/rename/delete)
* ğŸ”² Live Preview (iframe sandbox or Vercel/Sandpack) with hot reload
* ğŸ”² AI assist (chat + inline â€œgenerate/explain/fixâ€ actions)
* ğŸ”² PR flow (branch map â†’ open PR â†’ attach preview link)
* ğŸ”² Audit/logs viewer (read-only UI over existing logs)

---

## Critical Path (strict order)

1. **GitHub OAuth + repo import wizard** â†’ 2) **File tree + Monaco wired to backend** â†’ 3) **Save & basic file ops** â†’ 4) **Live preview** â†’ 5) **AI chat panel + inline actions** â†’ 6) **Branching & PR creation** â†’ 7) **Org/admin UI + audit viewer**.

---

## EPICS â†’ Scope, Acceptance Criteria, Dependencies

### 1) GitHubâ€‘First Onboarding

**Scope:** OAuth, repo selection, branch mapping, initial index, project dashboard card.
**Accept:**

* User logs in â†’ **Connect GitHub** â†’ sees list of repos (search + pagination)
* Pick repo + branch â†’ import completes â†’ project tile appears with last commit, branch, status
* Reconnect & token refresh handled; error states visible
  **Deps:** Octokit configured (âœ…), DB schemas (âœ…)
  **Effort:** **L**

### 2) IDE Core (Editor + Files)

**Scope:** Monaco setup, file tree, tabs, CRUD, autosave, dirty markers, quick search (âŒ˜P), format on save.
**Accept:**

* Open any file â†’ content loads <300ms P95 for typical files
* Create/rename/delete works; optimistic UI with rollback on failure
* Prettier/ESLint available; errors shown in problems panel
* Keyboard shortcuts: save, find, toggle sidebar
  **Deps:** Backend file APIs (partial), WebSocket (âœ… infra), DB (âœ…)
  **Effort:** **XL**

### 3) Live Preview

**Scope:** Choose **Sandpack** for instant sandbox; support Vite/Next projects; fallback to serverless preview URLs (Vercel) for full-stack.
**Accept:**

* â€œRun/Previewâ€ button opens live preview pane; hot reload within 2s
* Console logs captured; error overlay shows stack/line
* Toggle device sizes (mobile/tablet/desktop)
  **Deps:** IDE Core
  **Effort:** **L**

### 4) AI Assist (Chat + Inline)

**Scope:** Right-side chat dock + inline actions (Generate/Explain/Fix/Tests). Context: open file + selected range + repo index.
**Accept:**

* Streaming chat with markdown/code blocks, copy buttons
* Inline action inserts diffs; user can **Preview patch â†’ Apply**
* All generations logged to DB with file, diff, user
  **Deps:** OpenAI client (âœ…), Gen storage (âœ…)
  **Effort:** **L**

### 5) GitHub Workflows (PRs & Sync)

**Scope:** Branch mapping, open PR, status checks, preview links surfaced in UI.
**Accept:**

* â€œCreate Branchâ€ â†’ â€œOpen PRâ€ flow; PR URL surfaced; commit messages templated
* Incoming GitHub webhooks update build status badges
* Autoâ€‘generate PR summary (changeset + plainâ€‘English diff)
  **Deps:** GitHub events schema (âœ…)
  **Effort:** **M**

### 6) Org/Admin UI + Audit Viewer

**Scope:** Minimal settings area: members, roles, API keys (masked, rotate), audit log table with filters.
**Accept:**

* Invite by email; role change persists; key creation/rotation logged
* Audit table: filter by user, action, time; export CSV
  **Deps:** Security/audit backend (âœ…)
  **Effort:** **M**

### 7) Question Engine (Scaffolder) â€” v1.1

**Scope:** Upfront wizard to scaffold repos (Design tokens, components, integrations).
**Accept:**

* Answer Qs â†’ dryâ€‘run plan â†’ **Generate** â†’ PR with scaffold files + README
  **Deps:** AI assist + PR flow
  **Effort:** **M**

### 8) Realâ€‘time Collaboration â€” v1.1

**Scope:** Yjs doc sync, presence, cursors, file lock/merge strategy.
**Accept:**

* Two editors see live cursor, changes; conflictâ€‘free merges on text files
  **Deps:** WebSocket server (âœ…)
  **Effort:** **L**

### 9) CI/CD Integration â€” v1.1

**Scope:** Vercel/Netlify selection per project; show last deployments, preview links.
**Accept:**

* After PR, preview link displayed; status badges live update
  **Deps:** GitHub webhooks
  **Effort:** **S**

### 10) Component Registry & Design Tokens â€” v1.2

**Scope:** Pull components/tokens from registry; diff & apply updates.
**Accept:**

* â€œUpdate tokens/componentsâ€ opens diff â†’ apply â†’ PR
  **Effort:** **M**

---

## Sprint Plan (2â€‘week sprints)

### Sprint 0 â€” Stabilize & Decisions

* Pick **Sandpack** for preview; Monaco + shadcn + Tailwind baselines
* Backend file API endpoints finalized; error model unified
* Skeleton routes: `/projects`, `/project/:id/editor`, `/settings`

**Exit:** Helloâ€‘world project can open in editor (readâ€‘only), basic layout solid

### Sprint 1 â€” GitHub Onboarding + File Read

* OAuth connect, repo list, import flow, project card
* File tree read, open file in Monaco, problems panel skeleton

**Exit:** Import any public repo â†’ browse & open files

### Sprint 2 â€” File Ops + Live Preview

* Create/rename/delete, autosave, format
* Sandpack preview panel; device toggles; console capture

**Exit:** Edit React/Vite repo and see live preview

### Sprint 3 â€” AI Assist (Chat + Inline)

* Docked chat; context wiring; inline actions; diff preview/apply
* Log generations; rate limits; failure recovery

**Exit:** Generate component/tests and apply patch

### Sprint 4 â€” PR Flow + Admin/Audit

* Branching, PR creation, PR summary; webhook status
* Settings: members/roles, keys, audit log table

**Exit:** Edit â†’ Generate â†’ PR with preview link; basic admin usable

*(v1.1): add Question Engine, Realtime Collab, CI/CD dashboards*

---

## Definition of Done (per epic)

* **Perf:** P95 editor load < 500ms after cache warm; preview hot reload < 2s
* **DX:** Undo/redo safe, no data loss; clear error toasts; retryable actions
* **Security:** All mutations auditâ€‘logged; permission checks at API + UI
* **Reliability:** E2E tests for importâ†’editâ†’PR; recovery on 502/timeout

---

## Technical Choices

* **Editor:** Monaco (VSCode), file search via ripgrep wasm (later)
* **Preview:** Sandpack for FE; Vercel preview links for fullâ€‘stack
* **Collab:** Yjs + custom WS (postâ€‘MVP)
* **Terminal:** Defer; use CI logs + preview console first
* **Diffs:** Unified diff view; codeâ€‘mod safety checks

---

## Risks & Mitigations

* **GitHub rate limits:** Cache & backoff, ask for PAT if needed
* **Large repos:** Lazy index, virtualized trees, onâ€‘demand fetch
* **AI hallucinations:** Diff preview, small scoped actions, tests generation
* **Security drift:** Ship settings/audit UI early, RBAC enforced on every API

---

## Nonâ€‘Goals (v1)

* Full terminal, dockerized servers, marketplace billing, multiâ€‘cloud deploy

---

## Ship Checklist

* [ ] GitHub connect/import
* [ ] Editor + file ops
* [ ] Live preview
* [ ] AI chat + inline actions
* [ ] Branching + PR + preview link
* [ ] Settings + audit viewer
* [ ] E2E: importâ†’editâ†’PR green twice in a row
